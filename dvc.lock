schema: '2.0'
stages:
  preprocess:
    cmd: python src/preprocess/preprocess_data.py
    deps:
    - path: data/raw/test.tsv
      md5: 870876b5cdb5878d57c4c6b06aabb844
      size: 1061380
    - path: data/raw/train.tsv
      md5: c3f55c20dafae9e0687636a5c2a53c6c
      size: 17523321
    - path: data/raw/validation.tsv
      md5: 77296c9342a497534039d1ce6295962c
      size: 2196271
    - path: src/preprocess/preprocess_data.py
      md5: 9941bb4a9120f91a80420afe7b3b5b98
      size: 4087
    params:
      params.yaml:
        preprocess:
          script: src/preprocess/preprocess_data.py
          input_train: data/raw/train.tsv
          input_val: data/raw/validation.tsv
          input_test: data/raw/test.tsv
          output_train: data/processed/train_preprocessed.pkl
          output_val: data/processed/validation_preprocessed.pkl
          output_test: data/processed/test_preprocessed.pkl
    outs:
    - path: data/processed/test_preprocessed.pkl
      md5: 560374031d4a9715559a6f248d37c25a
      size: 864828
    - path: data/processed/train_preprocessed.pkl
      md5: cc2d2c312a6511b9aba2a2e81a75fa3f
      size: 15163692
    - path: data/processed/validation_preprocessed.pkl
      md5: c6cbd9bc38a543e6f33b3885e2561774
      size: 1922854
  featurize:
    cmd: python src/features/build_features.py
    deps:
    - path: data/processed/test_preprocessed.pkl
      md5: 560374031d4a9715559a6f248d37c25a
      size: 864828
    - path: data/processed/train_preprocessed.pkl
      md5: 0a1d784c205df0688c4e081de947303e
      size: 13822534
    - path: data/processed/validation_preprocessed.pkl
      md5: c6cbd9bc38a543e6f33b3885e2561774
      size: 1922854
    - path: src/features/build_features.py
      md5: 89fa1ca6c12f792aa47f68093176186d
      size: 4641
    params:
      params.yaml:
        featurize:
          script: src/features/build_features.py
          output_train: data/interim/train_featurized.pkl
          output_val: data/interim/validation_featurized.pkl
          output_test: data/interim/test_featurized.pkl
          mlb_out: models/mlb.pkl
          tfidf_vectorizer_out: models/tfidf_vectorizer.pkl
        preprocess:
          script: src/preprocess/preprocess_data.py
          input_train: data/raw/train.tsv
          input_val: data/raw/validation.tsv
          input_test: data/raw/test.tsv
          output_train: data/processed/train_preprocessed.pkl
          output_val: data/processed/validation_preprocessed.pkl
          output_test: data/processed/test_preprocessed.pkl
    outs:
    - path: data/interim/test_featurized.pkl
      md5: 46b1d7e98f6036df659baec05fdacb2b
      size: 1756847
    - path: data/interim/train_featurized.pkl
      md5: 947ccc86d832d55e6ac24f945da4f349
      size: 187841358
    - path: data/interim/validation_featurized.pkl
      md5: e9486cd55ba11ca2a298448f446b1093
      size: 26641356
    - path: models/mlb.pkl
      md5: 24fa46aeefc134dab1c55eb64a7219de
      size: 1880
    - path: models/tfidf_vectorizer.pkl
      md5: c0616019611ac24b9a9770b11c94ff3b
      size: 11876361
  train:
    cmd: python src/models/train_model.py
    deps:
    - path: data/interim/train_featurized.pkl
      md5: 947ccc86d832d55e6ac24f945da4f349
      size: 187841358
    - path: src/models/train_model.py
      md5: 212587d629ab2560318cd7c6b83932ab
      size: 1937
    params:
      params.yaml:
        featurize:
          script: src/features/build_features.py
          output_train: data/interim/train_featurized.pkl
          output_val: data/interim/validation_featurized.pkl
          output_test: data/interim/test_featurized.pkl
          mlb_out: models/mlb.pkl
          tfidf_vectorizer_out: models/tfidf_vectorizer.pkl
        train:
          script: src/models/train_model.py
          model_out: models/model.pkl
    outs:
    - path: models/model.pkl
      md5: 87bbc4a3c5156d2f219eacb8bfa537e4
      size: 31891531
  evaluate:
    cmd: python src/models/evaluate_model.py
    deps:
    - path: data/interim/validation_featurized.pkl
      md5: e9486cd55ba11ca2a298448f446b1093
      size: 26641356
    - path: models/model.pkl
      md5: 87bbc4a3c5156d2f219eacb8bfa537e4
      size: 31891531
    - path: src/models/evaluate_model.py
      md5: 6e55f449bfd03142e7dee8c6cbb529dc
      size: 3706
    params:
      params.yaml:
        evaluate:
          script: src/models/evaluate_model.py
          scores_path: reports/scores.json
          roc_json: reports/roc_plot.json
          prc_json: reports/prc_plot.json
        featurize:
          script: src/features/build_features.py
          output_train: data/interim/train_featurized.pkl
          output_val: data/interim/validation_featurized.pkl
          output_test: data/interim/test_featurized.pkl
          mlb_out: models/mlb.pkl
          tfidf_vectorizer_out: models/tfidf_vectorizer.pkl
        train:
          script: src/models/train_model.py
          model_out: models/model.pkl
    outs:
    - path: reports/scores.json
      md5: 1a55697c39b892d143fbfca9ba50b966
      size: 155
